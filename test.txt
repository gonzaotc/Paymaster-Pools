Compiling 1 files with Solc 0.8.30
Solc 0.8.30 finished in 5.17s
Compiler run successful with warnings:
Warning (2072): Unused local variable.
   --> test/UniswapPaymaster.t.sol:397:9:
    |
397 |         uint256 balanceBefore = token.balanceOf(address(EOA));
    |         ^^^^^^^^^^^^^^^^^^^^^


Ran 1 test for test/UniswapPaymaster.t.sol:PaymasterTest
[PASS] test_sponsor_user_operation() (gas: 628968)
Logs:
  Paymaster eth balance 0
  Entrypoint eth balance 1000000000000000000
  Sponsoring!
  _validatePaymasterUserOp
  Paymaster eth balance 0
  Entrypoint eth deposit 999475000000000000
  _validatePaymasterUserOp - maxCost 525000000000000
  swapDelta amount0 525000000000000
  swapDelta amount1 525525539320572
  taking tokens from user 525525539320572
  settling tokens to the pool manager 525525539320572
  taking ether from the pool manager 525000000000000
  PostOp
  Prefunded maxCost 525000000000000
  Actual Gas Cost 418163000000000
  Paymaster eth balance 525000000000000
  Entrypoint eth deposit 999475000000000000
  PostOp - excess ether 106837000000000
  PostOp - sending excess ether to the user
  PostOp - Refund succeeded
  PostOp - Paymaster eth balance after deposit 0
  PostOp - Entrypoint eth deposit after deposit 999893163000000000
  PostOp - finished
  Sponsoring done!
  Paymaster eth balance 0
  Entrypoint eth balance 999951477000000000

Traces:
  [648868] PaymasterTest::test_sponsor_user_operation()
    ├─ [0] console::log("Paymaster eth balance", 0) [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("Entrypoint eth balance", 1000000000000000000 [1e18]) [staticcall]
    │   └─ ← [Stop]
    ├─ [0] VM::prank(EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc])
    │   └─ ← [Return]
    ├─ [26927] ERC20PermitMock::approve(Permit2: [0x15cF58144EF33af1e14b5208015d11F9143E27b9], 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   ├─ emit Approval(owner: EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], spender: Permit2: [0x15cF58144EF33af1e14b5208015d11F9143E27b9], value: 115792089237316195423570985008687907853269984665640564039457584007913129639935 [1.157e77])
    │   └─ ← [Return] true
    ├─ [32919] ERC20PermitMock::mint(EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], 1000000000000000000000 [1e21])
    │   ├─ emit Transfer(from: 0x0000000000000000000000000000000000000000, to: EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], value: 1000000000000000000000 [1e21])
    │   └─ ← [Return]
    ├─ [0] VM::signDelegation(0x3D7Ebc40AF7092E3F1C81F2e996cbA5Cae2090d7, "<pk>")
    │   └─ ← [Return] (1, 0x9055184a5bc16cbf43d1524db3457bcf64f7bbca31a845110c29a62e0d4d4700, 0x5d8b21bb7b0d6eec320dedffb06a45d184661ec182e0f19303289e5f55a7fa56, 0, 0x3D7Ebc40AF7092E3F1C81F2e996cbA5Cae2090d7)
    ├─ [0] VM::attachDelegation((1, 0x9055184a5bc16cbf43d1524db3457bcf64f7bbca31a845110c29a62e0d4d4700, 0x5d8b21bb7b0d6eec320dedffb06a45d184661ec182e0f19303289e5f55a7fa56, 0, 0x3D7Ebc40AF7092E3F1C81F2e996cbA5Cae2090d7))
    │   └─ ← [Return]
    ├─ [609] Permit2::DOMAIN_SEPARATOR() [staticcall]
    │   └─ ← [Return] 0x56f6b489ae8572c523e618888346d4bcbe1c8ff31e11db59c0a09b3a413221dc
    ├─ [0] VM::sign("<pk>", 0xc8d8d7585c059e8b9dfc1e1938167a270b15e87a0bc99075fa47de009b4898d5) [staticcall]
    │   └─ ← [Return] 27, 0xd685d8f96e63cff4aea0fc57f3fd39e1c0027e3d4f25de8cfe229ac6441b6745, 0x525da35bf5048063800c6675f311c9d7ff1eb13a3de93f29b80f56c6e8994958
    ├─ [6437] EOA::getNonce() [staticcall]
    │   ├─ [4134] 0x4337084D9E255Ff0702461CF8895CE9E3b5Ff108::getNonce(EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], 0) [staticcall]
    │   │   └─ ← [Return] 0
    │   └─ ← [Return] 0
    ├─ [18983] PaymasterTest::signUserOp(PackedUserOperation({ sender: 0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc, nonce: 0, initCode: 0x, callData: 0xb61d27f60000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000044a9059cbb000000000000000000000000b6d4805bf6943c5875c0c7b67eda24b2bdacbf6e0000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000, accountGasLimits: 0x000000000000000000000000000124f80000000000000000000000000000c350, preVerificationGas: 50000 [5e4], gasFees: 0x0000000000000000000000003b9aca000000000000000000000000003b9aca00, paymasterAndData: 0x212224d2f2d262cd093ee13240ca4873fccbba3c000000000000000000000000000493e00000000000000000000000000000c35000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe300000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000003c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000ffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000e110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212224d2f2d262cd093ee13240ca4873fccbba3c0000000000000000000000000000000000000000000000000000000000000e1100000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000041d685d8f96e63cff4aea0fc57f3fd39e1c0027e3d4f25de8cfe229ac6441b6745525da35bf5048063800c6675f311c9d7ff1eb13a3de93f29b80f56c6e89949581b00000000000000000000000000000000000000000000000000000000000000, signature: 0x }), 71731427318746543473642848404856870898861693894998178473450514783689565215366 [7.173e76], 0x4337084D9E255Ff0702461CF8895CE9E3b5Ff108) [staticcall]
    │   ├─ [5399] 0x4337084D9E255Ff0702461CF8895CE9E3b5Ff108::getUserOpHash(PackedUserOperation({ sender: 0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc, nonce: 0, initCode: 0x, callData: 0xb61d27f60000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000044a9059cbb000000000000000000000000b6d4805bf6943c5875c0c7b67eda24b2bdacbf6e0000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000, accountGasLimits: 0x000000000000000000000000000124f80000000000000000000000000000c350, preVerificationGas: 50000 [5e4], gasFees: 0x0000000000000000000000003b9aca000000000000000000000000003b9aca00, paymasterAndData: 0x212224d2f2d262cd093ee13240ca4873fccbba3c000000000000000000000000000493e00000000000000000000000000000c35000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe300000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000003c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000ffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000e110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212224d2f2d262cd093ee13240ca4873fccbba3c0000000000000000000000000000000000000000000000000000000000000e1100000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000041d685d8f96e63cff4aea0fc57f3fd39e1c0027e3d4f25de8cfe229ac6441b6745525da35bf5048063800c6675f311c9d7ff1eb13a3de93f29b80f56c6e89949581b00000000000000000000000000000000000000000000000000000000000000, signature: 0x })) [staticcall]
    │   │   └─ ← [Return] 0xc071695159da270daf2cbe13c80a94869b18873420da26a4cb82f23c0969ebfa
    │   ├─ [0] VM::sign("<pk>", 0xc071695159da270daf2cbe13c80a94869b18873420da26a4cb82f23c0969ebfa) [staticcall]
    │   │   └─ ← [Return] 27, 0xb0fbc927a64d6e87e25949aef11857a22945504ce39d439037979844cbb016ce, 0x737ea8b0aadc393a147a9553b866edd76037626020ebd9dd900cf520aeb7de64
    │   └─ ← [Return] PackedUserOperation({ sender: 0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc, nonce: 0, initCode: 0x, callData: 0xb61d27f60000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000044a9059cbb000000000000000000000000b6d4805bf6943c5875c0c7b67eda24b2bdacbf6e0000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000, accountGasLimits: 0x000000000000000000000000000124f80000000000000000000000000000c350, preVerificationGas: 50000 [5e4], gasFees: 0x0000000000000000000000003b9aca000000000000000000000000003b9aca00, paymasterAndData: 0x212224d2f2d262cd093ee13240ca4873fccbba3c000000000000000000000000000493e00000000000000000000000000000c35000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe300000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000003c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000ffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000e110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212224d2f2d262cd093ee13240ca4873fccbba3c0000000000000000000000000000000000000000000000000000000000000e1100000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000041d685d8f96e63cff4aea0fc57f3fd39e1c0027e3d4f25de8cfe229ac6441b6745525da35bf5048063800c6675f311c9d7ff1eb13a3de93f29b80f56c6e89949581b00000000000000000000000000000000000000000000000000000000000000, signature: 0xb0fbc927a64d6e87e25949aef11857a22945504ce39d439037979844cbb016ce737ea8b0aadc393a147a9553b866edd76037626020ebd9dd900cf520aeb7de641b })
    ├─ [1262] ERC20PermitMock::balanceOf(EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc]) [staticcall]
    │   └─ ← [Return] 1000000000000000000000 [1e21]
    ├─ [0] console::log("Sponsoring!") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] VM::startPrank(bundler: [0x95c6771491b0CF0f47Dc3AEbb0E785408E742fFC])
    │   └─ ← [Return]
    ├─ [0] VM::expectEmit(true, true, true, true)
    │   └─ ← [Return]
    ├─ emit Transfer(from: EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], to: receiver: [0xB6D4805bf6943c5875C0C7b67EDa24b2bDACBF6e], value: 1000000000000000000 [1e18])
    ├─ [447208] 0x4337084D9E255Ff0702461CF8895CE9E3b5Ff108::handleOps([PackedUserOperation({ sender: 0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc, nonce: 0, initCode: 0x, callData: 0xb61d27f60000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000044a9059cbb000000000000000000000000b6d4805bf6943c5875c0c7b67eda24b2bdacbf6e0000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000, accountGasLimits: 0x000000000000000000000000000124f80000000000000000000000000000c350, preVerificationGas: 50000 [5e4], gasFees: 0x0000000000000000000000003b9aca000000000000000000000000003b9aca00, paymasterAndData: 0x212224d2f2d262cd093ee13240ca4873fccbba3c000000000000000000000000000493e00000000000000000000000000000c35000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe300000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000003c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000ffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000e110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212224d2f2d262cd093ee13240ca4873fccbba3c0000000000000000000000000000000000000000000000000000000000000e1100000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000041d685d8f96e63cff4aea0fc57f3fd39e1c0027e3d4f25de8cfe229ac6441b6745525da35bf5048063800c6675f311c9d7ff1eb13a3de93f29b80f56c6e89949581b00000000000000000000000000000000000000000000000000000000000000, signature: 0xb0fbc927a64d6e87e25949aef11857a22945504ce39d439037979844cbb016ce737ea8b0aadc393a147a9553b866edd76037626020ebd9dd900cf520aeb7de641b })], bundler: [0x95c6771491b0CF0f47Dc3AEbb0E785408E742fFC])
    │   ├─ [8368] EOA::validateUserOp(PackedUserOperation({ sender: 0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc, nonce: 0, initCode: 0x, callData: 0xb61d27f60000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000044a9059cbb000000000000000000000000b6d4805bf6943c5875c0c7b67eda24b2bdacbf6e0000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000, accountGasLimits: 0x000000000000000000000000000124f80000000000000000000000000000c350, preVerificationGas: 50000 [5e4], gasFees: 0x0000000000000000000000003b9aca000000000000000000000000003b9aca00, paymasterAndData: 0x212224d2f2d262cd093ee13240ca4873fccbba3c000000000000000000000000000493e00000000000000000000000000000c35000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe300000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000003c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000ffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000e110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212224d2f2d262cd093ee13240ca4873fccbba3c0000000000000000000000000000000000000000000000000000000000000e1100000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000041d685d8f96e63cff4aea0fc57f3fd39e1c0027e3d4f25de8cfe229ac6441b6745525da35bf5048063800c6675f311c9d7ff1eb13a3de93f29b80f56c6e89949581b00000000000000000000000000000000000000000000000000000000000000, signature: 0xb0fbc927a64d6e87e25949aef11857a22945504ce39d439037979844cbb016ce737ea8b0aadc393a147a9553b866edd76037626020ebd9dd900cf520aeb7de641b }), 0xc071695159da270daf2cbe13c80a94869b18873420da26a4cb82f23c0969ebfa, 0)
    │   │   ├─ [3000] PRECOMPILES::ecrecover(0xc071695159da270daf2cbe13c80a94869b18873420da26a4cb82f23c0969ebfa, 27, 80051928283881577738479271168836817340084634406615856461665947662319801603790, 52239764573568269616038618014634451682653789393213090746292275427822215356004) [staticcall]
    │   │   │   └─ ← [Return] 0x000000000000000000000000c958b338b1ce6add8f9ccfb102905a59c28e91fc
    │   │   └─ ← [Return] 0
    │   ├─ [271407] UniswapPaymaster::validatePaymasterUserOp(PackedUserOperation({ sender: 0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc, nonce: 0, initCode: 0x, callData: 0xb61d27f60000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000044a9059cbb000000000000000000000000b6d4805bf6943c5875c0c7b67eda24b2bdacbf6e0000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000, accountGasLimits: 0x000000000000000000000000000124f80000000000000000000000000000c350, preVerificationGas: 50000 [5e4], gasFees: 0x0000000000000000000000003b9aca000000000000000000000000003b9aca00, paymasterAndData: 0x212224d2f2d262cd093ee13240ca4873fccbba3c000000000000000000000000000493e00000000000000000000000000000c35000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe300000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000003c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000ffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000e110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212224d2f2d262cd093ee13240ca4873fccbba3c0000000000000000000000000000000000000000000000000000000000000e1100000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000041d685d8f96e63cff4aea0fc57f3fd39e1c0027e3d4f25de8cfe229ac6441b6745525da35bf5048063800c6675f311c9d7ff1eb13a3de93f29b80f56c6e89949581b00000000000000000000000000000000000000000000000000000000000000, signature: 0xb0fbc927a64d6e87e25949aef11857a22945504ce39d439037979844cbb016ce737ea8b0aadc393a147a9553b866edd76037626020ebd9dd900cf520aeb7de641b }), 0xc071695159da270daf2cbe13c80a94869b18873420da26a4cb82f23c0969ebfa, 525000000000000 [5.25e14])
    │   │   ├─ [0] console::log("_validatePaymasterUserOp") [staticcall]
    │   │   │   └─ ← [Stop]
    │   │   ├─ [0] console::log("Paymaster eth balance", 0) [staticcall]
    │   │   │   └─ ← [Stop]
    │   │   ├─ [1378] 0x4337084D9E255Ff0702461CF8895CE9E3b5Ff108::balanceOf(UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C]) [staticcall]
    │   │   │   └─ ← [Return] 999475000000000000 [9.994e17]
    │   │   ├─ [0] console::log("Entrypoint eth deposit", 999475000000000000 [9.994e17]) [staticcall]
    │   │   │   └─ ← [Stop]
    │   │   ├─ [43267] Permit2::permit(EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], PermitSingle({ details: PermitDetails({ token: 0x2a07706473244BC757E10F2a9E86fB532828afe3, amount: 1461501637330902918203684832716283019655932542975 [1.461e48], expiration: 3601, nonce: 0 }), spender: 0x212224D2F2d262cd093eE13240ca4873fcCBbA3C, sigDeadline: 3601 }), 0xd685d8f96e63cff4aea0fc57f3fd39e1c0027e3d4f25de8cfe229ac6441b6745525da35bf5048063800c6675f311c9d7ff1eb13a3de93f29b80f56c6e89949581b)
    │   │   │   ├─ [6928] EOA::isValidSignature(0xc8d8d7585c059e8b9dfc1e1938167a270b15e87a0bc99075fa47de009b4898d5, 0xd685d8f96e63cff4aea0fc57f3fd39e1c0027e3d4f25de8cfe229ac6441b6745525da35bf5048063800c6675f311c9d7ff1eb13a3de93f29b80f56c6e89949581b) [staticcall]
    │   │   │   │   ├─ [3000] PRECOMPILES::ecrecover(0xc8d8d7585c059e8b9dfc1e1938167a270b15e87a0bc99075fa47de009b4898d5, 27, 97031437758297571603418206013419822030956787476820019292769790734280269981509, 37255097824665270437865708458600214526592591367920293470368375731146968353112) [staticcall]
    │   │   │   │   │   └─ ← [Return] 0x000000000000000000000000c958b338b1ce6add8f9ccfb102905a59c28e91fc
    │   │   │   │   └─ ← [Return] 0x1626ba7e
    │   │   │   ├─ emit Permit(owner: EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], token: ERC20PermitMock: [0x2a07706473244BC757E10F2a9E86fB532828afe3], spender: UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C], amount: 1461501637330902918203684832716283019655932542975 [1.461e48], expiration: 3601, nonce: 0)
    │   │   │   └─ ← [Return]
    │   │   ├─ [0] console::log("_validatePaymasterUserOp - maxCost", 525000000000000 [5.25e14]) [staticcall]
    │   │   │   └─ ← [Stop]
    │   │   ├─ [200025] PoolManager::unlock(0x000000000000000000000000c958b338b1ce6add8f9ccfb102905a59c28e91fc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe300000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000003c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001dd7c1681d000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d25)
    │   │   │   ├─ [196423] UniswapPaymaster::unlockCallback(0x000000000000000000000000c958b338b1ce6add8f9ccfb102905a59c28e91fc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe300000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000003c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001dd7c1681d000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d25)
    │   │   │   │   ├─ [98221] PoolManager::swap(PoolKey({ currency0: 0x0000000000000000000000000000000000000000, currency1: 0x2a07706473244BC757E10F2a9E86fB532828afe3, fee: 1000, tickSpacing: 60, hooks: 0x0000000000000000000000000000000000000000 }), SwapParams({ zeroForOne: false, amountSpecified: 525000000000000 [5.25e14], sqrtPriceLimitX96: 1461446703485210103287273052203988822378723970341 [1.461e48] }), 0x)
    │   │   │   │   │   ├─ emit Swap(id: 0xa7dae1641f2b749a6441de9624aee885be6072e65013c6076d18e7a2a22ccd61, sender: UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C], amount0: 525000000000000 [5.25e14], amount1: -525525539320572 [-5.255e14], sqrtPriceX96: 79228164594003658186139977723 [7.922e28], liquidity: 20000000000000000000000 [2e22], tick: 0, fee: 1000)
    │   │   │   │   │   └─ ← [Return] 178648242633493033600638589840141774388481906228890884 [1.786e53]
    │   │   │   │   ├─ [0] console::log("swapDelta amount0", 525000000000000 [5.25e14]) [staticcall]
    │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   ├─ [0] console::log("swapDelta amount1", 525525539320572 [5.255e14]) [staticcall]
    │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   ├─ [0] console::log("taking tokens from user", 525525539320572 [5.255e14]) [staticcall]
    │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   ├─ [34036] Permit2::transferFrom(EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C], 525525539320572 [5.255e14], ERC20PermitMock: [0x2a07706473244BC757E10F2a9E86fB532828afe3])
    │   │   │   │   │   ├─ [30272] ERC20PermitMock::transferFrom(EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C], 525525539320572 [5.255e14])
    │   │   │   │   │   │   ├─ emit Transfer(from: EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], to: UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C], value: 525525539320572 [5.255e14])
    │   │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   │   └─ ← [Return]
    │   │   │   │   ├─ [0] console::log("settling tokens to the pool manager", 525525539320572 [5.255e14]) [staticcall]
    │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   ├─ [8294] PoolManager::sync(ERC20PermitMock: [0x2a07706473244BC757E10F2a9E86fB532828afe3])
    │   │   │   │   │   ├─ [3262] ERC20PermitMock::balanceOf(PoolManager: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 59907099118215618754 [5.99e19]
    │   │   │   │   │   └─ ← [Return]
    │   │   │   │   ├─ [10145] ERC20PermitMock::transfer(PoolManager: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], 525525539320572 [5.255e14])
    │   │   │   │   │   ├─ emit Transfer(from: UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C], to: PoolManager: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], value: 525525539320572 [5.255e14])
    │   │   │   │   │   └─ ← [Return] true
    │   │   │   │   ├─ [8460] PoolManager::settle()
    │   │   │   │   │   ├─ [1262] ERC20PermitMock::balanceOf(PoolManager: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f]) [staticcall]
    │   │   │   │   │   │   └─ ← [Return] 59907624643754939326 [5.99e19]
    │   │   │   │   │   └─ ← [Return] 525525539320572 [5.255e14]
    │   │   │   │   ├─ [0] console::log("taking ether from the pool manager", 525000000000000 [5.25e14]) [staticcall]
    │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   ├─ [11083] PoolManager::take(0x0000000000000000000000000000000000000000, UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C], 525000000000000 [5.25e14])
    │   │   │   │   │   ├─ [58] UniswapPaymaster::receive{value: 525000000000000}()
    │   │   │   │   │   │   └─ ← [Stop]
    │   │   │   │   │   └─ ← [Return]
    │   │   │   │   └─ ← [Return] 0x00000000000000000001dd7c1681d000fffffffffffffffffffe22098ce88d04
    │   │   │   └─ ← [Return] 0x00000000000000000001dd7c1681d000fffffffffffffffffffe22098ce88d04
    │   │   └─ ← [Return] 0x000000000000000000000000c958b338b1ce6add8f9ccfb102905a59c28e91fc0000000000000000000000000000000000000000000000000001dd7c1681d000, 0
    │   ├─ emit BeforeExecution()
    │   ├─ [93376] 0x4337084D9E255Ff0702461CF8895CE9E3b5Ff108::innerHandleOp(0xb61d27f60000000000000000000000002a07706473244bc757e10f2a9e86fb532828afe3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000044a9059cbb000000000000000000000000b6d4805bf6943c5875c0c7b67eda24b2bdacbf6e0000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000, UserOpInfo({ mUserOp: MemoryUserOp({ sender: 0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc, nonce: 0, verificationGasLimit: 75000 [7.5e4], callGasLimit: 50000 [5e4], paymasterVerificationGasLimit: 300000 [3e5], paymasterPostOpGasLimit: 50000 [5e4], preVerificationGas: 50000 [5e4], paymaster: 0x212224D2F2d262cd093eE13240ca4873fcCBbA3C, maxFeePerGas: 1000000000 [1e9], maxPriorityFeePerGas: 1000000000 [1e9] }), userOpHash: 0xc071695159da270daf2cbe13c80a94869b18873420da26a4cb82f23c0969ebfa, prefund: 525000000000000 [5.25e14], contextOffset: 736, preOpGas: 383883 [3.838e5] }), 0x000000000000000000000000c958b338b1ce6add8f9ccfb102905a59c28e91fc0000000000000000000000000000000000000000000000000001dd7c1681d000)
    │   │   ├─ [32110] EOA::execute(ERC20PermitMock: [0x2a07706473244BC757E10F2a9E86fB532828afe3], 0, 0xa9059cbb000000000000000000000000b6d4805bf6943c5875c0c7b67eda24b2bdacbf6e0000000000000000000000000000000000000000000000000de0b6b3a7640000)
    │   │   │   ├─ [29245] ERC20PermitMock::transfer(receiver: [0xB6D4805bf6943c5875C0C7b67EDa24b2bDACBF6e], 1000000000000000000 [1e18])
    │   │   │   │   ├─ emit Transfer(from: EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], to: receiver: [0xB6D4805bf6943c5875C0C7b67EDa24b2bDACBF6e], value: 1000000000000000000 [1e18])
    │   │   │   │   └─ ← [Return] true
    │   │   │   └─ ← [Return]
    │   │   ├─ [43757] UniswapPaymaster::postOp(0, 0x000000000000000000000000c958b338b1ce6add8f9ccfb102905a59c28e91fc0000000000000000000000000000000000000000000000000001dd7c1681d000, 418163000000000 [4.181e14], 1000000000 [1e9])
    │   │   │   ├─ [0] console::log("PostOp") [staticcall]
    │   │   │   │   └─ ← [Stop]
    │   │   │   ├─ [0] console::log("Prefunded maxCost", 525000000000000 [5.25e14]) [staticcall]
    │   │   │   │   └─ ← [Stop]
    │   │   │   ├─ [0] console::log("Actual Gas Cost", 418163000000000 [4.181e14]) [staticcall]
    │   │   │   │   └─ ← [Stop]
    │   │   │   ├─ [0] console::log("Paymaster eth balance", 525000000000000 [5.25e14]) [staticcall]
    │   │   │   │   └─ ← [Stop]
    │   │   │   ├─ [1378] 0x4337084D9E255Ff0702461CF8895CE9E3b5Ff108::balanceOf(UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C]) [staticcall]
    │   │   │   │   └─ ← [Return] 999475000000000000 [9.994e17]
    │   │   │   ├─ [0] console::log("Entrypoint eth deposit", 999475000000000000 [9.994e17]) [staticcall]
    │   │   │   │   └─ ← [Stop]
    │   │   │   ├─ [0] console::log("PostOp - excess ether", 106837000000000 [1.068e14]) [staticcall]
    │   │   │   │   └─ ← [Stop]
    │   │   │   ├─ [0] console::log("PostOp - sending excess ether to the user") [staticcall]
    │   │   │   │   └─ ← [Stop]
    │   │   │   ├─ [58] EOA::fallback{value: 106837000000000}()
    │   │   │   │   └─ ← [Stop]
    │   │   │   ├─ [0] console::log("PostOp - Refund succeeded") [staticcall]
    │   │   │   │   └─ ← [Stop]
    │   │   │   ├─ [3756] 0x4337084D9E255Ff0702461CF8895CE9E3b5Ff108::depositTo{value: 418163000000000}(UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C])
    │   │   │   │   ├─ emit Deposited(account: UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C], totalDeposit: 999893163000000000 [9.998e17])
    │   │   │   │   └─ ← [Return]
    │   │   │   ├─ [0] console::log("PostOp - Paymaster eth balance after deposit", 0) [staticcall]
    │   │   │   │   └─ ← [Stop]
    │   │   │   ├─ [1378] 0x4337084D9E255Ff0702461CF8895CE9E3b5Ff108::balanceOf(UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C]) [staticcall]
    │   │   │   │   └─ ← [Return] 999893163000000000 [9.998e17]
    │   │   │   ├─ [0] console::log("PostOp - Entrypoint eth deposit after deposit", 999893163000000000 [9.998e17]) [staticcall]
    │   │   │   │   └─ ← [Stop]
    │   │   │   ├─ [0] console::log("PostOp - finished") [staticcall]
    │   │   │   │   └─ ← [Stop]
    │   │   │   └─ ← [Return]
    │   │   ├─ emit UserOperationEvent(userOpHash: 0xc071695159da270daf2cbe13c80a94869b18873420da26a4cb82f23c0969ebfa, sender: EOA: [0xC958B338b1cE6ADd8f9CcfB102905a59c28e91Fc], paymaster: UniswapPaymaster: [0x212224D2F2d262cd093eE13240ca4873fcCBbA3C], nonce: 0, success: true, actualGasCost: 466686000000000 [4.666e14], actualGasUsed: 466686 [4.666e5])
    │   │   └─ ← [Return] 466686000000000 [4.666e14]
    │   ├─ [0] bundler::fallback{value: 466686000000000}()
    │   │   └─ ← [Stop]
    │   └─ ← [Return]
    ├─ [0] VM::stopPrank()
    │   └─ ← [Return]
    ├─ [0] console::log("Sponsoring done!") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("Paymaster eth balance", 0) [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("Entrypoint eth balance", 999951477000000000 [9.999e17]) [staticcall]
    │   └─ ← [Stop]
    ├─ [1262] ERC20PermitMock::balanceOf(receiver: [0xB6D4805bf6943c5875C0C7b67EDa24b2bDACBF6e]) [staticcall]
    │   └─ ← [Return] 1000000000000000000 [1e18]
    ├─ [0] VM::assertEq(1000000000000000000 [1e18], 1000000000000000000 [1e18]) [staticcall]
    │   └─ ← [Return]
    └─ ← [Return]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 8.26ms (2.32ms CPU time)

Ran 1 test suite in 150.55ms (8.26ms CPU time): 1 tests passed, 0 failed, 0 skipped (1 total tests)
